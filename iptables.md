Добавляем правила:

```
iptables -A INPUT -p tcp --dport 80 -j ACCEPT

iptables -A INPUT -p tcp --dport 3306 -j ACCEPT

iptables -A INPUT -s 192.168.250.230 -p tcp --dport 22 -j ACCEPT

iptables -P INPUT DROP
```

Проверяем:

```
root@debian:~# iptables -vnL
Chain INPUT (policy DROP 430 packets, 27991 bytes)
 pkts bytes target     prot opt in     out     source               destination
    8  1276 ACCEPT     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            tcp dpt:80
    0     0 ACCEPT     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            tcp dpt:3306
  120  6576 ACCEPT     tcp  --  *      *       192.168.250.230      0.0.0.0/0            tcp dpt:22

Chain FORWARD (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination

Chain OUTPUT (policy ACCEPT 5783 packets, 599K bytes)
 pkts bytes target     prot opt in     out     source               destination
```

Сохраняем

```
root@debian:~# iptables-save
# Generated by xtables-save v1.8.2 on Thu Dec  2 00:32:42 2021
*filter
:INPUT DROP [461:30808]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [7113:735036]
-A INPUT -p tcp -m tcp --dport 80 -j ACCEPT
-A INPUT -p tcp -m tcp --dport 3306 -j ACCEPT
-A INPUT -s 192.168.250.230/32 -p tcp -m tcp --dport 22 -j ACCEPT
COMMIT
# Completed on Thu Dec  2 00:32:42 2021
```

По совету из инета пишем скрипт и помещаем его для запуска после поднятия интерфейса:

```
nano -w /etc/network/if-up.d/00-iptables
```

```
#!/bin/sh
 iptables-restore < /etc/firewall.conf
```

Даем права на выполнение:

```
chmod +x /etc/network/if-up.d/00-iptables
```

Сохраняем:

```
iptables-save >/etc/firewall.conf
```



Проверяем:

```
root@debian:~# date && uptime
Чт дек  2 00:45:47 +05 2021
 00:45:47 up 3 min,  1 user,  load average: 0,05, 0,11, 0,05
```

```
root@debian:~# reboot
```

```
root@debian:~# date && uptime
Чт дек  2 00:47:11 +05 2021
 00:47:11 up 0 min,  1 user,  load average: 0,74, 0,19, 0,06
root@debian:~# iptables -vnL
Chain INPUT (policy DROP 42 packets, 4591 bytes)
 pkts bytes target     prot opt in     out     source               destination
    0     0 ACCEPT     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            tcp dpt:80
    0     0 ACCEPT     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            tcp dpt:3306
  263 19412 ACCEPT     tcp  --  *      *       192.168.250.230      0.0.0.0/0            tcp dpt:22

Chain FORWARD (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination

Chain OUTPUT (policy ACCEPT 342 packets, 41789 bytes)
 pkts bytes target     prot opt in     out     source               destination

```

